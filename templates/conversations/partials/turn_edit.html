<div class="flex {% if turn.role == 'agent' %}justify-end{% else %}justify-start{% endif %} py-2">
    <div class="max-w-[75%] w-full bg-white border-2 border-indigo-300 rounded-lg p-3">
        <div class="text-xs font-medium text-gray-700 mb-2">
            {% if turn.role == 'agent' %}Restaurant AI{% else %}Customer{% endif %}
            <span class="text-gray-400 ml-2">{% if turn.time_in_call_secs %}{{ turn.time_in_call_secs|floatformat:1 }}s{% endif %}</span>
        </div>

        <div class="mb-2">
            <label class="text-xs text-gray-500 block mb-1">Original:</label>
            <p class="text-sm text-gray-400 italic">{{ turn.original_text }}</p>
        </div>

        <form hx-post="{% url 'turn_edit' conversation.pk turn.pk %}"
              hx-target="#turn-{{ turn.pk }}"
              hx-swap="innerHTML">
            {% csrf_token %}
            <label class="text-xs text-gray-500 block mb-1">Edited:</label>
            <textarea name="edited_text" rows="3"
                class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500">{% if turn.is_edited %}{{ turn.edited_text }}{% else %}{{ turn.original_text }}{% endif %}</textarea>

            <div class="flex justify-end space-x-2 mt-2">
                <button type="button"
                    hx-get="{% url 'turn_display' conversation.pk turn.pk %}"
                    hx-target="#turn-{{ turn.pk }}"
                    hx-swap="innerHTML"
                    class="px-3 py-1 text-sm text-gray-600 bg-gray-100 rounded hover:bg-gray-200">Cancel</button>
                <button type="submit"
                    class="px-3 py-1 text-sm text-white bg-indigo-600 rounded hover:bg-indigo-700">Save Edit</button>
            </div>
        </form>
    </div>
</div>

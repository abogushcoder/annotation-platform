{% load conversation_tags %}
<div class="bg-white border-2 border-indigo-300 rounded-lg p-4 mt-2">
    <h4 class="text-sm font-semibold text-gray-700 mb-3">Edit Tool Call: {{ tc.tool_name }}</h4>

    <form hx-post="{% url 'tool_call_edit' conversation.pk tc.pk %}"
          hx-target="#toolcall-{{ tc.pk }}"
          hx-swap="innerHTML">
        {% csrf_token %}

        {% get_tool_fields tc as fields %}
        {% for field in fields %}
        <div class="mb-3">
            <label class="block text-xs font-medium text-gray-600 mb-1">{{ field.label }}</label>
            {% if field.type == 'textarea' %}
            <textarea name="arg_{{ field.name }}" rows="2"
                class="w-full rounded-md border border-gray-300 px-3 py-1.5 text-sm focus:border-indigo-500 focus:outline-none">{{ field.value }}</textarea>
            {% elif field.type == 'number' %}
            <input type="number" name="arg_{{ field.name }}" value="{{ field.value }}"
                class="w-full rounded-md border border-gray-300 px-3 py-1.5 text-sm focus:border-indigo-500 focus:outline-none">
            {% elif field.type == 'json' %}
            <textarea name="arg_{{ field.name }}" rows="4"
                class="w-full rounded-md border border-gray-300 px-3 py-1.5 text-sm font-mono focus:border-indigo-500 focus:outline-none">{{ field.value }}</textarea>
            {% else %}
            <input type="text" name="arg_{{ field.name }}" value="{{ field.value }}"
                class="w-full rounded-md border border-gray-300 px-3 py-1.5 text-sm focus:border-indigo-500 focus:outline-none">
            {% endif %}
        </div>
        {% endfor %}

        <div class="flex justify-end space-x-2 mt-3">
            <button type="button"
                hx-get="{% url 'tool_call_display' conversation.pk tc.pk %}"
                hx-target="#toolcall-{{ tc.pk }}"
                hx-swap="innerHTML"
                class="px-3 py-1 text-sm text-gray-600 bg-gray-100 rounded hover:bg-gray-200">Cancel</button>
            <button type="submit"
                class="px-3 py-1 text-sm text-white bg-indigo-600 rounded hover:bg-indigo-700">Save Changes</button>
        </div>
    </form>
</div>

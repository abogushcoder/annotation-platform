{% load conversation_tags %}
{% get_tool_display_data tc as d %}
{% get_tool_card_template tc as card_tpl %}
<div class="bg-white border {% if d.has_error %}border-red-200{% else %}border-gray-300{% endif %} rounded-lg p-3 mt-2">
    <div class="flex items-center justify-between mb-2">
        <span class="text-xs font-semibold text-gray-700 bg-gray-100 px-2 py-0.5 rounded">
            {{ tc.tool_name }}
        </span>
        <div class="flex items-center gap-2">
            {% if tc.is_edited %}
            <span class="text-[10px] text-green-600 font-medium">Edited</span>
            {% endif %}
            {% if d.has_error %}
            <span class="text-xs text-red-600 font-medium">Error</span>
            {% elif tc.status_code == 200 %}
            <span class="text-xs text-green-600">Success</span>
            {% elif tc.status_code %}
            <span class="text-xs text-red-600">Error ({{ tc.status_code }})</span>
            {% endif %}
        </div>
    </div>

    {% if d.has_error %}
    <div class="bg-red-50 text-red-700 text-xs rounded px-2 py-1.5 mb-2">{{ d.error_message }}</div>
    {% endif %}

    {% include card_tpl with d=d tc=tc %}

    {% if conversation.status in 'assigned,in_progress' %}
    <div class="mt-2 flex items-center space-x-2 border-t border-gray-100 pt-2">
        <button hx-get="{% url 'tool_call_edit' conversation.pk tc.pk %}"
                hx-target="#toolcall-{{ tc.pk }}"
                hx-swap="innerHTML"
                class="text-xs text-indigo-600 hover:text-indigo-800">Edit Tool Call</button>
        {% if not tc.is_edited %}
        <span class="text-xs text-gray-400">Looks Good &#10003;</span>
        {% endif %}
    </div>
    {% endif %}
</div>
